{
  "annotations": {
    "list": []
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "liveNow": true,
  "panels": [
    {
      "gridPos": { "h": 2, "w": 24, "x": 0, "y": 0 },
      "id": 1,
      "options": {
        "content": "# Fleet Wall Connectors\nReal-time status of all Wall Connectors via Tesla Fleet API",
        "mode": "markdown"
      },
      "title": "",
      "transparent": true,
      "type": "text"
    },
    {
      "datasource": { "type": "influxdb", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "decimals": 1,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "text", "value": null },
              { "color": "green", "value": 0.1 }
            ]
          },
          "unit": "kwatt"
        },
        "overrides": []
      },
      "gridPos": { "h": 5, "w": 5, "x": 0, "y": 2 },
      "id": 2,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "textMode": "value_and_name"
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": { "type": "influxdb", "uid": "${datasource}" },
          "query": "from(bucket: \"twc_dashboard\")\n  |> range(start: -5m)\n  |> filter(fn: (r) => r._measurement == \"twc_fleet_status\")\n  |> filter(fn: (r) => r._field == \"power_kw\")\n  |> last()\n  |> group()\n  |> sum()\n  |> keep(columns: [\"_value\"])\n  |> rename(columns: {_value: \"Total\"})",
          "refId": "A"
        }
      ],
      "title": "Total Power",
      "description": "Combined power draw from all Wall Connectors",
      "type": "stat"
    },
    {
      "datasource": { "type": "influxdb", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "decimals": 0,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "text", "value": null },
              { "color": "green", "value": 1 }
            ]
          },
          "unit": "none"
        },
        "overrides": []
      },
      "gridPos": { "h": 5, "w": 4, "x": 5, "y": 2 },
      "id": 3,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "textMode": "value_and_name"
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": { "type": "influxdb", "uid": "${datasource}" },
          "query": "from(bucket: \"twc_dashboard\")\n  |> range(start: -5m)\n  |> filter(fn: (r) => r._measurement == \"twc_fleet_status\")\n  |> filter(fn: (r) => r._field == \"is_charging\")\n  |> last()\n  |> map(fn: (r) => ({r with _value: if r._value then 1 else 0}))\n  |> group()\n  |> sum()\n  |> keep(columns: [\"_value\"])\n  |> rename(columns: {_value: \"Charging\"})",
          "refId": "A"
        }
      ],
      "title": "Units Charging",
      "description": "Number of Wall Connectors currently charging",
      "type": "stat"
    },
    {
      "datasource": { "type": "influxdb", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "decimals": 0,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "text", "value": null },
              { "color": "blue", "value": 1 }
            ]
          },
          "unit": "none"
        },
        "overrides": []
      },
      "gridPos": { "h": 5, "w": 4, "x": 9, "y": 2 },
      "id": 4,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "textMode": "value_and_name"
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": { "type": "influxdb", "uid": "${datasource}" },
          "query": "from(bucket: \"twc_dashboard\")\n  |> range(start: -5m)\n  |> filter(fn: (r) => r._measurement == \"twc_fleet_status\")\n  |> filter(fn: (r) => r._field == \"is_connected\")\n  |> last()\n  |> map(fn: (r) => ({r with _value: if r._value then 1 else 0}))\n  |> group()\n  |> sum()\n  |> keep(columns: [\"_value\"])\n  |> rename(columns: {_value: \"Connected\"})",
          "refId": "A"
        }
      ],
      "title": "Vehicles Connected",
      "description": "Number of vehicles currently connected",
      "type": "stat"
    },
    {
      "datasource": { "type": "influxdb", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "decimals": 0,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "blue", "value": null }
            ]
          },
          "unit": "none"
        },
        "overrides": []
      },
      "gridPos": { "h": 5, "w": 3, "x": 13, "y": 2 },
      "id": 5,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "textMode": "value_and_name"
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": { "type": "influxdb", "uid": "${datasource}" },
          "query": "from(bucket: \"twc_dashboard\")\n  |> range(start: -5m)\n  |> filter(fn: (r) => r._measurement == \"twc_fleet_status\")\n  |> filter(fn: (r) => r._field == \"power_kw\")\n  |> last()\n  |> group()\n  |> count()\n  |> keep(columns: [\"_value\"])\n  |> rename(columns: {_value: \"Total\"})",
          "refId": "A"
        }
      ],
      "title": "Total Units",
      "description": "Number of Wall Connectors discovered",
      "type": "stat"
    },
    {
      "datasource": { "type": "influxdb", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "decimals": 1,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "text", "value": null },
              { "color": "green", "value": 0.1 }
            ]
          },
          "unit": "kwatth"
        },
        "overrides": []
      },
      "gridPos": { "h": 5, "w": 4, "x": 16, "y": 2 },
      "id": 6,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "textMode": "value_and_name"
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": { "type": "influxdb", "uid": "${datasource}" },
          "query": "from(bucket: \"twc_dashboard\")\n  |> range(start: today())\n  |> filter(fn: (r) => r._measurement == \"fleet_charge_session\")\n  |> filter(fn: (r) => r._field == \"energy_kwh\")\n  |> filter(fn: (r) => r.unit_name != \"unknown\")\n  |> group()\n  |> sum()\n  |> keep(columns: [\"_value\"])\n  |> rename(columns: {_value: \"Today\"})",
          "refId": "A"
        }
      ],
      "title": "Today's Energy",
      "description": "Total energy delivered today across all Wall Connectors",
      "type": "stat"
    },
    {
      "datasource": { "type": "influxdb", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "decimals": 0,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "text", "value": null },
              { "color": "green", "value": 1 }
            ]
          },
          "unit": "none"
        },
        "overrides": []
      },
      "gridPos": { "h": 5, "w": 4, "x": 20, "y": 2 },
      "id": 7,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": ["lastNotNull"],
          "fields": "",
          "values": false
        },
        "textMode": "value_and_name"
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": { "type": "influxdb", "uid": "${datasource}" },
          "query": "from(bucket: \"twc_dashboard\")\n  |> range(start: today())\n  |> filter(fn: (r) => r._measurement == \"fleet_charge_session\")\n  |> filter(fn: (r) => r._field == \"energy_kwh\")\n  |> filter(fn: (r) => r.unit_name != \"unknown\")\n  |> group()\n  |> count()\n  |> keep(columns: [\"_value\"])\n  |> rename(columns: {_value: \"Sessions\"})",
          "refId": "A"
        }
      ],
      "title": "Sessions Today",
      "description": "Number of charging sessions completed today",
      "type": "stat"
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 7 },
      "id": 10,
      "panels": [],
      "title": "Wall Connector Status",
      "type": "row"
    },
    {
      "datasource": { "type": "influxdb", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "custom": {
            "align": "auto",
            "cellOptions": { "type": "auto" },
            "inspect": false,
            "filterable": false
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null }
            ]
          }
        },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "Unit" },
            "properties": [
              { "id": "custom.width", "value": 150 }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Power" },
            "properties": [
              { "id": "unit", "value": "kwatt" },
              { "id": "decimals", "value": 2 },
              { "id": "custom.width", "value": 100 }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "State" },
            "properties": [
              { "id": "custom.width", "value": 120 },
              {
                "id": "mappings",
                "value": [
                  { "options": { "Charging": { "color": "green", "index": 0 } }, "type": "value" },
                  { "options": { "Connected": { "color": "blue", "index": 1 } }, "type": "value" },
                  { "options": { "Ready": { "color": "blue", "index": 2 } }, "type": "value" },
                  { "options": { "Disconnected": { "color": "text", "index": 3 } }, "type": "value" }
                ]
              },
              { "id": "custom.cellOptions", "value": { "type": "color-background" } }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Vehicle" },
            "properties": [
              { "id": "custom.width", "value": 150 }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Type" },
            "properties": [
              { "id": "custom.width", "value": 80 }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Fault" },
            "properties": [
              { "id": "custom.width", "value": 100 },
              {
                "id": "mappings",
                "value": [
                  { "options": { "No Fault": { "color": "green", "index": 0 } }, "type": "value" },
                  { "options": { "Power Limited": { "color": "orange", "index": 1 } }, "type": "value" },
                  { "options": { "Unknown": { "color": "text", "index": 2 } }, "type": "value" }
                ]
              },
              { "id": "custom.cellOptions", "value": { "type": "color-text" } }
            ]
          }
        ]
      },
      "gridPos": { "h": 6, "w": 12, "x": 0, "y": 8 },
      "id": 11,
      "options": {
        "cellHeight": "md",
        "footer": { "countRows": false, "fields": "", "reducer": ["sum"], "show": false },
        "showHeader": true,
        "sortBy": [{ "desc": false, "displayName": "Unit" }]
      },
      "transformations": [
        {
          "id": "organize",
          "options": {
            "indexByName": {
              "Unit": 0,
              "Type": 1,
              "State": 2,
              "Fault": 3,
              "Vehicle": 4,
              "Power": 5
            },
            "renameByName": {}
          }
        }
      ],
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": { "type": "influxdb", "uid": "${datasource}" },
          "query": "from(bucket: \"twc_dashboard\")\n  |> range(start: -5m)\n  |> filter(fn: (r) => r._measurement == \"twc_fleet_status\")\n  |> filter(fn: (r) => r._field == \"power_kw\" or r._field == \"state_name\" or r._field == \"connected_vehicle_name\" or r._field == \"is_connected\" or r._field == \"fault_name\")\n  |> last()\n  |> pivot(rowKey: [\"unit_name\", \"unit_type\"], columnKey: [\"_field\"], valueColumn: \"_value\")\n  |> map(fn: (r) => ({\n      Unit: r.unit_name,\n      Power: r.power_kw,\n      State: r.state_name,\n      Fault: if exists r.fault_name then r.fault_name else \"Unknown\",\n      Vehicle: if r.is_connected and exists r.connected_vehicle_name and r.connected_vehicle_name != \"\" then r.connected_vehicle_name else (if r.is_connected then \"Connected\" else \"--\"),\n      Type: if r.unit_type == \"leader\" then \"Leader\" else \"Follower\"\n  }))\n  |> keep(columns: [\"Unit\", \"Power\", \"State\", \"Fault\", \"Vehicle\", \"Type\"])\n  |> sort(columns: [\"Unit\"])",
          "refId": "A"
        }
      ],
      "title": "All Wall Connectors",
      "description": "Real-time status of all Wall Connectors",
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 14 },
      "id": 20,
      "panels": [],
      "title": "Power History",
      "type": "row"
    },
    {
      "datasource": { "type": "influxdb", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Power (kW)",
            "axisPlacement": "auto",
            "axisSoftMax": 15,
            "axisSoftMin": 0,
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "stepAfter",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "decimals": 1,
          "mappings": [],
          "min": 0,
          "max": 25,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null }
            ]
          },
          "unit": "kwatt"
        },
        "overrides": []
      },
      "gridPos": { "h": 8, "w": 24, "x": 0, "y": 15 },
      "id": 21,
      "options": {
        "legend": {
          "calcs": ["lastNotNull", "max", "mean"],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": { "type": "influxdb", "uid": "${datasource}" },
          "query": "from(bucket: \"twc_dashboard\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r._measurement == \"twc_fleet_status\")\n  |> filter(fn: (r) => r._field == \"power_kw\")\n  |> aggregateWindow(every: v.windowPeriod, fn: mean, createEmpty: false)\n  |> keep(columns: [\"_time\", \"_value\", \"unit_name\"])",
          "refId": "A"
        }
      ],
      "title": "Power by Wall Connector",
      "description": "Power draw from each Wall Connector over time",
      "type": "timeseries"
    },
    {
      "datasource": { "type": "influxdb", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "custom": {
            "align": "auto",
            "cellOptions": { "type": "auto" },
            "inspect": false,
            "filterable": true
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null }
            ]
          }
        },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "Time" },
            "properties": [
              { "id": "custom.width", "value": 145 }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Unit" },
            "properties": [
              { "id": "custom.width", "value": 130 }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Vehicle" },
            "properties": [
              { "id": "custom.width", "value": 130 }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Energy" },
            "properties": [
              { "id": "unit", "value": "kwatth" },
              { "id": "decimals", "value": 1 },
              { "id": "custom.width", "value": 95 }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Duration" },
            "properties": [
              { "id": "custom.width", "value": 95 }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Avg Power" },
            "properties": [
              { "id": "unit", "value": "kwatt" },
              { "id": "decimals", "value": 1 },
              { "id": "custom.width", "value": 105 }
            ]
          }
        ]
      },
      "gridPos": { "h": 6, "w": 12, "x": 12, "y": 8 },
      "id": 31,
      "options": {
        "cellHeight": "sm",
        "footer": { "countRows": false, "fields": "", "reducer": ["sum"], "show": false },
        "showHeader": true,
        "sortBy": [{ "desc": true, "displayName": "Time" }]
      },
      "transformations": [
        {
          "id": "organize",
          "options": {
            "indexByName": {
              "Time": 0,
              "Unit": 1,
              "Duration": 2,
              "Avg Power": 3,
              "Vehicle": 4,
              "Energy": 5
            },
            "renameByName": {}
          }
        }
      ],
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": { "type": "influxdb", "uid": "${datasource}" },
          "query": "import \"strings\"\n\nfrom(bucket: \"twc_dashboard\")\n  |> range(start: today())\n  |> filter(fn: (r) => r._measurement == \"fleet_charge_session\")\n  |> filter(fn: (r) => r.unit_name != \"unknown\")\n  |> pivot(rowKey: [\"_time\"], columnKey: [\"_field\"], valueColumn: \"_value\")\n  |> map(fn: (r) => ({\n      Time: strings.substring(v: string(v: r._time), start: 0, end: 16),\n      Unit: r.unit_name,\n      Vehicle: r.vehicle_name,\n      Energy: r.energy_kwh,\n      Duration: string(v: int(v: r.duration_min)) + \" min\",\n      \"Avg Power\": r.avg_power_kw\n  }))\n  |> keep(columns: [\"Time\", \"Unit\", \"Vehicle\", \"Energy\", \"Duration\", \"Avg Power\"])\n  |> sort(columns: [\"Time\"], desc: true)",
          "refId": "A"
        }
      ],
      "title": "Today's Charging Sessions",
      "description": "Charging sessions completed today",
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": { "h": 1, "w": 24, "x": 0, "y": 23 },
      "id": 40,
      "panels": [],
      "title": "Usage Statistics",
      "type": "row"
    },
    {
      "datasource": { "type": "influxdb", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "custom": {
            "align": "auto",
            "cellOptions": { "type": "auto" },
            "inspect": false,
            "filterable": false
          },
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null }
            ]
          }
        },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "Unit" },
            "properties": [
              { "id": "custom.width", "value": 140 }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Last Session" },
            "properties": [
              { "id": "custom.width", "value": 145 }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Time Ago" },
            "properties": [
              { "id": "custom.width", "value": 100 }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Energy" },
            "properties": [
              { "id": "unit", "value": "kwatth" },
              { "id": "decimals", "value": 1 },
              { "id": "custom.width", "value": 90 }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Vehicle" },
            "properties": [
              { "id": "custom.width", "value": 130 }
            ]
          }
        ]
      },
      "gridPos": { "h": 5, "w": 12, "x": 0, "y": 24 },
      "id": 41,
      "options": {
        "cellHeight": "sm",
        "footer": { "countRows": false, "fields": "", "reducer": ["sum"], "show": false },
        "showHeader": true,
        "sortBy": [{ "desc": true, "displayName": "Last Session" }]
      },
      "transformations": [
        {
          "id": "organize",
          "options": {
            "indexByName": {
              "Unit": 0,
              "Last Session": 1,
              "Time Ago": 2,
              "Vehicle": 3,
              "Energy": 4
            },
            "renameByName": {}
          }
        }
      ],
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": { "type": "influxdb", "uid": "${datasource}" },
          "query": "import \"strings\"\nimport \"date\"\n\nfrom(bucket: \"twc_dashboard\")\n  |> range(start: -30d)\n  |> filter(fn: (r) => r._measurement == \"fleet_charge_session\")\n  |> filter(fn: (r) => r._field == \"energy_kwh\")\n  |> filter(fn: (r) => r.unit_name != \"unknown\")\n  |> group(columns: [\"unit_name\"])\n  |> last()\n  |> map(fn: (r) => {\n      hours = int(v: uint(v: now()) - uint(v: r._time)) / 3600000000000\n      return {\n        Unit: r.unit_name,\n        \"Last Session\": strings.substring(v: string(v: r._time), start: 0, end: 16),\n        \"Time Ago\": if hours < 24 then string(v: hours) + \"h ago\" else string(v: hours / 24) + \"d ago\",\n        Vehicle: r.vehicle_name,\n        Energy: r._value\n      }\n  })\n  |> keep(columns: [\"Unit\", \"Last Session\", \"Time Ago\", \"Vehicle\", \"Energy\"])",
          "refId": "A"
        }
      ],
      "title": "Last Session by Unit",
      "description": "Most recent charging session for each Wall Connector",
      "type": "table"
    },
    {
      "datasource": { "type": "influxdb", "uid": "${datasource}" },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Energy (kWh)",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "bars",
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": { "legend": false, "tooltip": false, "viz": false },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": { "type": "linear" },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": { "group": "A", "mode": "none" },
            "thresholdsStyle": { "mode": "off" }
          },
          "decimals": 1,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              { "color": "green", "value": null }
            ]
          },
          "unit": "kwatth"
        },
        "overrides": [
          {
            "matcher": { "id": "byName", "options": "This Week" },
            "properties": [
              { "id": "color", "value": { "fixedColor": "green", "mode": "fixed" } }
            ]
          },
          {
            "matcher": { "id": "byName", "options": "Last Week" },
            "properties": [
              { "id": "color", "value": { "fixedColor": "blue", "mode": "fixed" } }
            ]
          }
        ]
      },
      "gridPos": { "h": 5, "w": 12, "x": 12, "y": 24 },
      "id": 42,
      "options": {
        "legend": {
          "calcs": ["sum"],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": { "type": "influxdb", "uid": "${datasource}" },
          "query": "import \"date\"\n\nfrom(bucket: \"twc_dashboard\")\n  |> range(start: date.truncate(t: now(), unit: 1w))\n  |> filter(fn: (r) => r._measurement == \"fleet_charge_session\")\n  |> filter(fn: (r) => r._field == \"energy_kwh\")\n  |> filter(fn: (r) => r.unit_name != \"unknown\")\n  |> group()\n  |> aggregateWindow(every: 1d, fn: sum, createEmpty: false, timeSrc: \"_start\")\n  |> rename(columns: {_value: \"This Week\"})\n  |> keep(columns: [\"_time\", \"This Week\"])",
          "refId": "A"
        },
        {
          "datasource": { "type": "influxdb", "uid": "${datasource}" },
          "query": "import \"date\"\nimport \"experimental\"\n\nlastWeekStart = experimental.subDuration(d: 1w, from: date.truncate(t: now(), unit: 1w))\nlastWeekEnd = date.truncate(t: now(), unit: 1w)\n\nfrom(bucket: \"twc_dashboard\")\n  |> range(start: lastWeekStart, stop: lastWeekEnd)\n  |> filter(fn: (r) => r._measurement == \"fleet_charge_session\")\n  |> filter(fn: (r) => r._field == \"energy_kwh\")\n  |> filter(fn: (r) => r.unit_name != \"unknown\")\n  |> group()\n  |> aggregateWindow(every: 1d, fn: sum, createEmpty: false, timeSrc: \"_start\")\n  |> timeShift(duration: 1w)\n  |> rename(columns: {_value: \"Last Week\"})\n  |> keep(columns: [\"_time\", \"Last Week\"])",
          "refId": "B",
          "hide": false
        }
      ],
      "title": "This Week vs Last Week",
      "description": "Daily energy comparison between this week and last week",
      "type": "timeseries"
    }
  ],
  "refresh": "5s",
  "schemaVersion": 38,
  "tags": ["twc", "fleet-api", "wall-connector"],
  "templating": {
    "list": [
      {
        "current": { "selected": false, "text": "InfluxDB", "value": "InfluxDB" },
        "hide": 0,
        "includeAll": false,
        "multi": false,
        "name": "datasource",
        "options": [],
        "query": "influxdb",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "type": "datasource"
      }
    ]
  },
  "time": {
    "from": "now-1h",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "browser",
  "title": "Fleet Wall Connectors",
  "uid": "fleet-wall-connectors",
  "version": 1,
  "weekStart": ""
}
